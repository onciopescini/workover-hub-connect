# Manual Penetration Testing Checklist

## Overview
Manual security testing checklist following OWASP Top 10 methodology.

**Tester**: _____________________  
**Date**: _____________________  
**Environment**: Production / Staging  
**Version**: _____________________

---

## 1. SQL Injection Testing

### Input Fields to Test
- [ ] Login form (email, password)
- [ ] Space search filters
- [ ] Booking creation form
- [ ] Message content
- [ ] Review/rating forms
- [ ] Admin search fields

### Payloads to Try
```sql
' OR '1'='1
'; DROP TABLE users;--
' UNION SELECT NULL,NULL,NULL--
admin'--
' OR 1=1--
```

### Results
- [ ] No SQL injection vulnerabilities found
- [ ] All inputs properly sanitized
- [ ] Parameterized queries verified
- [ ] RLS policies prevent unauthorized access

**Notes**: _____________________

---

## 2. Cross-Site Scripting (XSS)

### Reflected XSS
Test URL parameters:
- [ ] `/spaces?search=<script>alert('XSS')</script>`
- [ ] `/bookings?id=<img src=x onerror=alert('XSS')>`

### Stored XSS
Test inputs that persist:
- [ ] Space description: `<script>alert('XSS')</script>`
- [ ] Review content: `<img src=x onerror=alert(document.cookie)>`
- [ ] Message content: `<svg onload=alert('XSS')>`
- [ ] User profile bio: `<iframe src="javascript:alert('XSS')">`

### DOM-based XSS
- [ ] Check React component rendering
- [ ] Verify dangerouslySetInnerHTML is not used
- [ ] Test URL fragment manipulation

### Results
- [ ] Content Security Policy (CSP) active
- [ ] All user inputs sanitized (DOMPurify)
- [ ] React auto-escaping verified
- [ ] No XSS vulnerabilities found

**Notes**: _____________________

---

## 3. Authentication & Session Management

### Authentication Bypass Attempts
- [ ] JWT token manipulation
- [ ] Session hijacking attempts
- [ ] Brute force protection tested
- [ ] Password reset flow security
- [ ] OAuth flow security (Google)

### JWT Testing
```javascript
// Decode JWT and try:
- Modify user_id claim
- Change role to 'admin'
- Remove signature
- Use expired token
- Use 'none' algorithm
```

### Session Testing
- [ ] Session timeout enforced (30 min)
- [ ] Concurrent session handling
- [ ] Logout invalidates session
- [ ] Session fixation prevented

### Results
- [ ] Strong password policy enforced
- [ ] JWT properly validated
- [ ] Session security verified
- [ ] No authentication bypass found

**Notes**: _____________________

---

## 4. Authorization & Access Control

### Horizontal Privilege Escalation
- [ ] User A tries to access User B's bookings
- [ ] User A tries to modify User B's profile
- [ ] User A tries to read User B's messages

### Vertical Privilege Escalation
- [ ] Regular user tries admin endpoints
- [ ] Coworker tries host-only actions
- [ ] Guest tries authenticated actions

### Test Scenarios
```bash
# Try accessing other user's booking
GET /bookings?user_id=<other_user_id>

# Try modifying other user's space
PUT /spaces/<space_id> (not owned by current user)

# Try admin actions as regular user
POST /admin/users/suspend
```

### Results
- [ ] RLS policies prevent unauthorized access
- [ ] Role-based access control (RBAC) working
- [ ] No privilege escalation found
- [ ] Audit logs capture attempts

**Notes**: _____________________

---

## 5. CSRF (Cross-Site Request Forgery)

### Test State-Changing Operations
- [ ] Booking creation
- [ ] Payment processing
- [ ] Profile update
- [ ] Space publication
- [ ] Message sending

### CSRF Token Verification
- [ ] CSRF token present in forms
- [ ] Token validated server-side
- [ ] Token unique per session
- [ ] Token expires appropriately

### Results
- [ ] CSRF protection active
- [ ] SameSite cookie attribute set
- [ ] No CSRF vulnerabilities found

**Notes**: _____________________

---

## 6. Sensitive Data Exposure

### Data in Transit
- [ ] HTTPS enforced (HTTP → HTTPS redirect)
- [ ] TLS 1.2+ only
- [ ] HSTS header present
- [ ] No mixed content warnings

### Data at Rest
- [ ] Passwords hashed (bcrypt/scrypt)
- [ ] Sensitive fields encrypted
- [ ] Database backups encrypted
- [ ] PII handling compliant (GDPR)

### Data in Logs
- [ ] No passwords in logs
- [ ] No credit card data in logs
- [ ] No JWT tokens in logs
- [ ] No PII in error messages

### Results
- [ ] Encryption verified
- [ ] No sensitive data exposure
- [ ] Secure data handling confirmed

**Notes**: _____________________

---

## 7. Security Misconfiguration

### HTTP Headers
- [ ] X-Frame-Options: DENY
- [ ] X-Content-Type-Options: nosniff
- [ ] Content-Security-Policy present
- [ ] Strict-Transport-Security present
- [ ] X-XSS-Protection: 1; mode=block

### Error Handling
- [ ] No stack traces exposed
- [ ] Generic error messages to users
- [ ] Detailed errors only in logs
- [ ] Custom error pages (404, 500)

### Default Credentials
- [ ] No default admin credentials
- [ ] Database credentials changed
- [ ] API keys rotated

### Results
- [ ] Security headers configured
- [ ] Error handling secure
- [ ] No misconfigurations found

**Notes**: _____________________

---

## 8. Insecure Direct Object References (IDOR)

### Test Scenarios
```bash
# Try accessing other user's resources by ID
GET /api/bookings/<other_user_booking_id>
GET /api/messages/<other_user_message_id>
GET /api/payments/<other_user_payment_id>

# Try UUID enumeration
GET /api/spaces/<random_uuid>
```

### Results
- [ ] Authorization checks on all endpoints
- [ ] UUIDs prevent enumeration
- [ ] RLS policies prevent IDOR
- [ ] No direct object references exposed

**Notes**: _____________________

---

## 9. File Upload Vulnerabilities

### File Upload Testing
- [ ] File type validation (whitelist)
- [ ] File size limits enforced
- [ ] Malicious file upload attempts
- [ ] Path traversal prevention
- [ ] Virus scanning (if applicable)

### Test Payloads
```bash
# Upload malicious files
- shell.php.jpg
- ../../../etc/passwd
- file.svg with embedded JS
- .htaccess file
```

### Results
- [ ] File uploads properly validated
- [ ] Storage bucket security configured
- [ ] No file upload vulnerabilities

**Notes**: _____________________

---

## 10. Business Logic Vulnerabilities

### Payment Flow
- [ ] Payment amount tampering
- [ ] Negative prices prevention
- [ ] Double-spending prevention
- [ ] Refund logic security

### Booking Logic
- [ ] Overbooking prevention
- [ ] Race condition handling
- [ ] Cancellation policy enforcement
- [ ] Slot reservation expiry

### Rate Limiting
- [ ] API rate limits enforced
- [ ] Login attempt limits
- [ ] Message sending limits
- [ ] Search query limits

### Results
- [ ] Business logic secure
- [ ] Race conditions handled
- [ ] No logic flaws found

**Notes**: _____________________

---

## 11. API Security

### API Endpoint Testing
- [ ] Authentication required on sensitive endpoints
- [ ] Proper HTTP methods enforced (GET/POST/PUT/DELETE)
- [ ] Request size limits
- [ ] Response size limits
- [ ] API versioning security

### GraphQL/REST Security
- [ ] Query depth limiting
- [ ] Introspection disabled in production
- [ ] Batch request limits
- [ ] Field-level authorization

### Results
- [ ] API endpoints secured
- [ ] No unauthorized access
- [ ] Rate limiting effective

**Notes**: _____________________

---

## 12. Third-Party Dependencies

### Dependency Audit
- [ ] npm audit passed (0 high/critical)
- [ ] Supabase client version latest
- [ ] React version patched
- [ ] Stripe SDK version secure
- [ ] Sentry SDK version latest

### CDN Security
- [ ] Subresource Integrity (SRI) for CDN assets
- [ ] CDN sources trusted
- [ ] No deprecated dependencies

### Results
- [ ] Dependencies up to date
- [ ] No known vulnerabilities
- [ ] SRI hashes verified

**Notes**: _____________________

---

## Summary

### Critical Findings
_____________________

### High Findings
_____________________

### Medium Findings
_____________________

### Low/Info Findings
_____________________

### Recommendations
_____________________

### Overall Risk Rating
- [ ] Low
- [ ] Medium
- [ ] High
- [ ] Critical

**Sign-off**:
- Security Engineer: _____________________
- Date: _____________________
- Status: ✅ PASSED / ❌ FAILED
